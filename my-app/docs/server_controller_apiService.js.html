<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>server/controller/apiService.js - Summoners Card</title>
    
    <meta name="description" content="A stats viewing fullstack web application using the Riot API" />
    
        <meta name="keywords" content="jsdoc, docdash" />
        <meta name="keyword" content="jsdoc, docdash" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/jack-pap/Summoners-Card" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Modules</h3><ul><li><a href="module-apiService.html">apiService</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-apiService.html#.apiGETDatabaseCall">apiGETDatabaseCall</a></li><li data-type='method' style='display: none;'><a href="module-apiService.html#.apiImageCall">apiImageCall</a></li><li data-type='method' style='display: none;'><a href="module-apiService.html#.apiPOSTDatabaseCall">apiPOSTDatabaseCall</a></li><li data-type='method' style='display: none;'><a href="module-apiService.html#.apiPUTDatabaseCall">apiPUTDatabaseCall</a></li><li data-type='method' style='display: none;'><a href="module-apiService.html#.exports.apiProxyCall">exports.apiProxyCall</a></li></ul></li><li><a href="module-App.html">App</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-App.html#.getMatchList">getMatchList</a></li><li data-type='method' style='display: none;'><a href="module-App.html#.getSummonerStats">getSummonerStats</a></li><li data-type='method' style='display: none;'><a href="module-App.html#.makeApiCall">makeApiCall</a></li><li data-type='method' style='display: none;'><a href="module-App.html#.matchInfoListDriver">matchInfoListDriver</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~findMoreMatches">findMoreMatches</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~formatDateSQL">formatDateSQL</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getAllChampions">getAllChampions</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getChampionWinrate">getChampionWinrate</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getInput">getInput</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getMasteryInfo">getMasteryInfo</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getPUUID">getPUUID</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getRankedInfo">getRankedInfo</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~getSummonerInfo">getSummonerInfo</a></li><li data-type='method' style='display: none;'><a href="module-App.html#~loadVersion">loadVersion</a></li></ul></li><li><a href="module-Dashboard.html">Dashboard</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~checkIfOwnPlayer">checkIfOwnPlayer</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getItemAssets">getItemAssets</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getOtherPlayerAssets">getOtherPlayerAssets</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getRuneImage">getRuneImage</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getSummonerItemImage">getSummonerItemImage</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getSummonerRuneAssets">getSummonerRuneAssets</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getSummonerSpellAssets">getSummonerSpellAssets</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~getSummonerSpellImage">getSummonerSpellImage</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~loadWinrate">loadWinrate</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeChampionWinrate">makeChampionWinrate</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeMainRoleBadge">makeMainRoleBadge</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeMillionBadge">makeMillionBadge</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeMostPlayedBadge">makeMostPlayedBadge</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeProfileIcon">makeProfileIcon</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeStreakBadge">makeStreakBadge</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeSummonerBadges">makeSummonerBadges</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~makeSummonerProfile">makeSummonerProfile</a></li><li data-type='method' style='display: none;'><a href="module-Dashboard.html#~updateProgressBar">updateProgressBar</a></li></ul></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">server/controller/apiService.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module apiService
 */

/**
 * API call to Riot for data by calling the proxy route
 * server and passing the apiURL endpoint
 * @memberof module:apiService  
 * @param {string} apiURL
 * @returns {Promise}
 */
export function apiProxyCall(apiURL) {
  const proxyURL = `http://localhost:3001/proxy?url=${encodeURIComponent(
    apiURL
  )}`;
  return new Promise((resolve, reject) => {
    fetch(proxyURL)
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Network response was not ok ${response.status}`);
        }
        return response.json();
      })
      .then((data) => {
        resolve(data);
        console.log(data);
      })
      .catch((error) => {
        reject(error);
        console.log(data);
      });
  });
}

/**
 * API call to imageURL to get image data
 *
 * @param {string} imageURL
 * @returns {Promise}
 */
export function apiImageCall(imageURL) {
  return new Promise((resolve, reject) => {
    fetch(imageURL)
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Image data failed to request: ${response.status}`);
        }
        return response.blob();
      })
      .then((blob) => {
        const url = URL.createObjectURL(blob);
        resolve(url);
      })
      .catch((error) => {
        console.error(error);
        resolve(null);
      });
  });
}

/**
 * API POST call to server to create
 * new database entry
 * 
 * @param {string} path
 * @param {string} queryRoute
 * @param {JSON} summonerJSONObject
 * @returns {Promise}
 */
export function apiPOSTDatabaseCall(path, queryRoute, summonerJSONObject) {
  const queryRouteURL = `http://localhost:3001/${path}/${queryRoute}`;

  return new Promise((resolve, reject) => {
    fetch(queryRouteURL, {
      method: "post",
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(summonerJSONObject)
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Network response was not ok ${response.status}`);
        }
        return response.json();
      })
      .then((data) => {
        resolve(data);   
        console.log(data);
      })
      .catch((error) => {
        reject(error);
        console.log(data);
      });
  });
}

/**
 * API GET call to server to request data from
 * the database
 * 
 * @param {string} path
 * @param {string} queryRoute
 * @returns {Promise}
 */
export function apiGETDatabaseCall(path, queryRoute) {
  const queryRouteURL = `http://localhost:3001/${path}/${queryRoute}`;

  return new Promise((resolve, reject) => {
    fetch(queryRouteURL)
      .then((response) => {
        if (!response.ok) {
          throw new Error(`Network response was not ok ${response.status}`);
        }
        return response.json();
      })
      .then((data) => {
        resolve(data);
      })
      .catch((error) => {
        reject(error);
        console.log(data);
      });
  });
}

/**
 * API PUT call to server to modify data from
 * the database
 * 
 * @param {string} path
 * @param {string} queryRoute
 * @param {JSON} summonerJSONObject
 * @returns {Promise}
 */
export function apiPUTDatabaseCall(path, queryRoute) {
  const queryRouteURL = `http://localhost:3001/${path}/${queryRoute}`;

  return new Promise((resolve, reject) => {
    fetch(queryRouteURL, {
      method: "PUT",
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        resolve(data);
        console.log(data);
      })
      .catch(error => {
        console.error('Error:', error);
        throw error;
      });
  });
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Mon Sep 30 2024 01:09:02 GMT+0300 (Eastern European Summer Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
